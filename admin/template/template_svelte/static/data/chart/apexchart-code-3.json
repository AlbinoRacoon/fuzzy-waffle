<script>
  import ApexCharts from '/src/components/plugins/ApexCharts.svelte';
  import { onMount } from 'svelte';
  import { appVariables } from '/src/stores/appVariables.js';
  
  let chartData = [];
  
  function getChartData(appVariables) {
    return {
      options: {
        chart: { height: 350, type: 'area' },
        series: [
          { name: 'series1', data: [31, 40, 28, 51, 42, 109, 100] },
          { name: 'series2', data: [11, 32, 45, 32, 34, 52, 41] }
        ],
        dataLabels: { enabled: false },
        stroke: { curve: 'smooth', width: 3 },
        colors: [appVariables.color.pink, appVariables.color.gray600],
        xaxis: {
          type: 'datetime',
          categories: ['2024-09-19T00:00:00', '2024-09-19T01:30:00', '2024-09-19T02:30:00', '2024-09-19T03:30:00', '2024-09-19T04:30:00', '2024-09-19T05:30:00', '2024-09-19T06:30:00'],
          axisBorder: {
            show: true,
            color: appVariables.color.gray300,
            height: 1,
            width: '100%',
            offsetX: 0,
            offsetY: -1
          },
          axisTicks: {
            show: true,
            borderType: 'solid',
            color: appVariables.color.gray300,
            height: 6,
            offsetX: 0,
            offsetY: 0
          }             
        },
        tooltip: {
          x: { format: 'dd/MM/yy HH:mm' }
        }
      }
    };
  }

  onMount(async () => {
    appVariables.subscribe(value => {
      if (value.color) {
        chartData = getChartData(value);
      }
    });
  });
</script>

{#if chartData}
  <ApexCharts options={chartData.options}></ApexCharts>
{/if}